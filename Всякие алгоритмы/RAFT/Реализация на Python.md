Алгоритм Raft - это алгоритм распределенного консенсуса, разработанный для поддержки систем с распределенным хранилищем данных. Вот шаги алгоритма Raft:

1. **Выбор лидера (Leader Election)**:
    
    - Начинается с выбора случайного таймаута для каждого сервера.
    - Сервер, чье время вышло первым, становится кандидатом и начинает выборы.
    - Кандидат отправляет запросы голосования (vote requests) другим серверам.
    - Серверы голосуют за кандидата, если еще не проголосовали за другого кандидата.
    - Если кандидат получает большинство голосов, он становится лидером.
2. **Репликация лога (Log Replication)**:
    
    - Лидер принимает запросы клиентов и реплицирует операции в логе на других серверах (фолловерах).
    - Лидер отправляет append entries RPC с записями журнала фолловерам.
    - Фолловеры сохраняют запиcи и отправляют подтверждение лидеру.
    - Когда большинство серверов подтвердит записи, операция считается безопасной и применяется к состоянию.
3. **Коллективное решение (Collective Decision)**:
    
    - Лидер принимает запросы клиентов и координирует коллективные действия серверов.
    - Лидер обновляет фолловеров с новым состоянием системы и синхронизирует их себя.
4. **Смена лидера (Leader Change)**:
    
    - Если лидер перестает отвечать (timeout), серверы инициируют новые выборы.
    - Серверы переходят в новые состояния кандидата и начинают новый раунд выборов.
    - Процесс повторяется до тех пор, пока серверы не выберут нового лидера.
5. **Обработка неустойчивости (Handling Instability)**:
    
    - В случае сбоя или нестабильности сервера, Raft обеспечивает переход к новому лидеру без потери данных.
